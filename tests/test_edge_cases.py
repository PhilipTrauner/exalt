from exalt import promote

# One element too big for non-extended arguments
LARGE_NAMESPACE_SIZE = 256
LARGE_NAMESPACE = {f"bar_{bar_idx}": bar_idx for bar_idx in range(LARGE_NAMESPACE_SIZE)}


def huge_foo():
    return (
        bar_255,
        bar_254,
        bar_253,
        bar_252,
        bar_251,
        bar_250,
        bar_249,
        bar_248,
        bar_247,
        bar_246,
        bar_245,
        bar_244,
        bar_243,
        bar_242,
        bar_241,
        bar_240,
        bar_239,
        bar_238,
        bar_237,
        bar_236,
        bar_235,
        bar_234,
        bar_233,
        bar_232,
        bar_231,
        bar_230,
        bar_229,
        bar_228,
        bar_227,
        bar_226,
        bar_225,
        bar_224,
        bar_223,
        bar_222,
        bar_221,
        bar_220,
        bar_219,
        bar_218,
        bar_217,
        bar_216,
        bar_215,
        bar_214,
        bar_213,
        bar_212,
        bar_211,
        bar_210,
        bar_209,
        bar_208,
        bar_207,
        bar_206,
        bar_205,
        bar_204,
        bar_203,
        bar_202,
        bar_201,
        bar_200,
        bar_199,
        bar_198,
        bar_197,
        bar_196,
        bar_195,
        bar_194,
        bar_193,
        bar_192,
        bar_191,
        bar_190,
        bar_189,
        bar_188,
        bar_187,
        bar_186,
        bar_185,
        bar_184,
        bar_183,
        bar_182,
        bar_181,
        bar_180,
        bar_179,
        bar_178,
        bar_177,
        bar_176,
        bar_175,
        bar_174,
        bar_173,
        bar_172,
        bar_171,
        bar_170,
        bar_169,
        bar_168,
        bar_167,
        bar_166,
        bar_165,
        bar_164,
        bar_163,
        bar_162,
        bar_161,
        bar_160,
        bar_159,
        bar_158,
        bar_157,
        bar_156,
        bar_155,
        bar_154,
        bar_153,
        bar_152,
        bar_151,
        bar_150,
        bar_149,
        bar_148,
        bar_147,
        bar_146,
        bar_145,
        bar_144,
        bar_143,
        bar_142,
        bar_141,
        bar_140,
        bar_139,
        bar_138,
        bar_137,
        bar_136,
        bar_135,
        bar_134,
        bar_133,
        bar_132,
        bar_131,
        bar_130,
        bar_129,
        bar_128,
        bar_127,
        bar_126,
        bar_125,
        bar_124,
        bar_123,
        bar_122,
        bar_121,
        bar_120,
        bar_119,
        bar_118,
        bar_117,
        bar_116,
        bar_115,
        bar_114,
        bar_113,
        bar_112,
        bar_111,
        bar_110,
        bar_109,
        bar_108,
        bar_107,
        bar_106,
        bar_105,
        bar_104,
        bar_103,
        bar_102,
        bar_101,
        bar_100,
        bar_99,
        bar_98,
        bar_97,
        bar_96,
        bar_95,
        bar_94,
        bar_93,
        bar_92,
        bar_91,
        bar_90,
        bar_89,
        bar_88,
        bar_87,
        bar_86,
        bar_85,
        bar_84,
        bar_83,
        bar_82,
        bar_81,
        bar_80,
        bar_79,
        bar_78,
        bar_77,
        bar_76,
        bar_75,
        bar_74,
        bar_73,
        bar_72,
        bar_71,
        bar_70,
        bar_69,
        bar_68,
        bar_67,
        bar_66,
        bar_65,
        bar_64,
        bar_63,
        bar_62,
        bar_61,
        bar_60,
        bar_59,
        bar_58,
        bar_57,
        bar_56,
        bar_55,
        bar_54,
        bar_53,
        bar_52,
        bar_51,
        bar_50,
        bar_49,
        bar_48,
        bar_47,
        bar_46,
        bar_45,
        bar_44,
        bar_43,
        bar_42,
        bar_41,
        bar_40,
        bar_39,
        bar_38,
        bar_37,
        bar_36,
        bar_35,
        bar_34,
        bar_33,
        bar_32,
        bar_31,
        bar_30,
        bar_29,
        bar_28,
        bar_27,
        bar_26,
        bar_25,
        bar_24,
        bar_23,
        bar_22,
        bar_21,
        bar_20,
        bar_19,
        bar_18,
        bar_17,
        bar_16,
        bar_15,
        bar_14,
        bar_13,
        bar_12,
        bar_11,
        bar_10,
        bar_9,
        bar_8,
        bar_7,
        bar_6,
        bar_5,
        bar_4,
        bar_3,
        bar_2,
        bar_1,
        bar_0,
    )


def test_extended_wrong_order():
    assert (
        promote(huge_foo, **LARGE_NAMESPACE)() == tuple(LARGE_NAMESPACE.values())[::-1]
    )
